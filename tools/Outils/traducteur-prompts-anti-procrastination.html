<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traducteur de Prompts ‚Äì Version Anti-Procrastination</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #7f5af0 0, #16161a 55%);
            min-height: 100vh;
            padding: 20px;
            color: #111827;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #f9fafb;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.35);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #7f5af0 0%, #2cb67d 100%);
            color: white;
            padding: 28px 24px 22px;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header h1 span {
            font-size: 1.6rem;
        }

        .header p {
            opacity: 0.95;
            font-size: 0.98rem;
        }

        .badge-header {
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            background: rgba(15,23,42,0.2);
            padding: 4px 10px;
            border-radius: 999px;
        }

        .badge-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #2cb67d;
        }

        .main {
            padding: 24px;
            display: grid;
            grid-template-columns: minmax(0,1fr) minmax(0,1fr);
            gap: 20px;
        }

        .info-box {
            grid-column: 1 / -1;
            background: #e0f2fe;
            border-left: 4px solid #0284c7;
            border-radius: 10px;
            padding: 14px 16px;
            font-size: 0.9rem;
        }

        .info-box strong {
            color: #0369a1;
        }

        .info-box ul {
            margin-left: 18px;
            margin-top: 6px;
        }

        .info-box li {
            margin: 2px 0;
        }

        .panel {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .pill {
            padding: 2px 9px;
            border-radius: 999px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .pill-input {
            background: #fbbf24;
            color: #78350f;
        }

        .pill-output {
            background: #22c55e;
            color: #022c22;
        }

        .panel-title {
            font-weight: 600;
            color: #111827;
        }

        textarea {
            width: 100%;
            min-height: 360px;
            padding: 14px 14px 40px;
            border-radius: 12px;
            border: 1.5px solid #e5e7eb;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.9rem;
            resize: vertical;
            outline: none;
            background: white;
            line-height: 1.5;
            transition: border-color 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
        }

        #inputPrompt {
            background: #fffbeb;
        }

        #outputPrompt {
            background: #eff6ff;
        }

        textarea:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99,102,241,0.25);
        }

        .placeholder {
            color: #9ca3af;
        }

        .btn-row {
            grid-column: 1 / -1;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 8px;
        }

        button {
            border: none;
            cursor: pointer;
            border-radius: 999px;
            padding: 10px 22px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
        }

        button span.emoji {
            font-size: 1.1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7f5af0, #4338ca);
            color: white;
            box-shadow: 0 8px 20px rgba(79,70,229,0.5);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 12px 26px rgba(79,70,229,0.65);
        }

        .btn-secondary {
            background: #22c55e;
            color: #052e16;
        }

        .btn-secondary:hover {
            background: #16a34a;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #ef4444;
            color: #fef2f2;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .stats {
            grid-column: 1 / -1;
            margin-top: 12px;
            padding: 10px 12px;
            border-radius: 999px;
            background: #f3f4f6;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            font-size: 0.8rem;
        }

        .stat-chip {
            padding: 5px 10px;
            border-radius: 999px;
            background: white;
            display: inline-flex;
            align-items: baseline;
            gap: 4px;
            border: 1px solid #e5e7eb;
        }

        .stat-label {
            color: #6b7280;
        }

        .stat-value {
            font-weight: 600;
            color: #111827;
        }

        .footer-note {
            grid-column: 1 / -1;
            margin-top: 8px;
            font-size: 0.75rem;
            color: #6b7280;
            text-align: right;
        }

        @media (max-width: 840px) {
            .main {
                grid-template-columns: minmax(0,1fr);
            }
            .stats {
                border-radius: 14px;
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <header class="header">
        <h1><span>üéØ</span> Traducteur de Prompts ‚Äì Optimiseur Anti-Procrastination</h1>
        <p>Colle ton prompt brut ‚Üí r√©cup√®re un super-prompt structur√©, avec r√¥le, objectif, contraintes et r√®gle anti-procrastination int√©gr√©e.</p>
        <div class="badge-header">
            <div class="badge-dot"></div>
            <span>Compatible GPT-5.1 Thinking / GPT-4 & co</span>
        </div>
    </header>

    <main class="main">
        <section class="info-box">
            <strong>Mode d‚Äôemploi :</strong>
            <ul>
                <li>üìù Colle ton prompt ‚Äúnaturel‚Äù √† gauche (m√™me tr√®s brouillon).</li>
                <li>‚ö° Clique sur <strong>‚ÄúTraduire le prompt‚Äù</strong>.</li>
                <li>üìã R√©cup√®re √† droite un prompt ultra-cadr√© pr√™t √† √™tre coll√© dans ChatGPT.</li>
                <li>üö´ La sortie int√®gre automatiquement : r√¥le, objectif, contraintes, format, validations + mode <strong>anti-procrastination</strong> et tol√©rance √† l‚Äôincertitude.</li>
            </ul>
        </section>

        <section class="panel">
            <div class="panel-header">
                <span class="pill pill-input">Entr√©e</span>
                <span class="panel-title">Prompt brut</span>
            </div>
            <textarea id="inputPrompt" placeholder="Exemple : 

Fais-moi l‚ÄôOCR de ces 10 pages et g√©n√®re un JSON structur√© complet pour entra√Æner un GPT sp√©cialis√©. 
Tol√©rance aux zones floues : tu marques [illisible] quand tu ne peux pas lire."></textarea>
        </section>

        <section class="panel">
            <div class="panel-header">
                <span class="pill pill-output">Sortie</span>
                <span class="panel-title">Prompt optimis√©</span>
            </div>
            <textarea id="outputPrompt" readonly placeholder="Le prompt optimis√© appara√Ætra ici..."></textarea>
        </section>

        <div class="btn-row">
            <button class="btn-primary" id="btnTranslate">
                <span class="emoji">‚ö°</span> Traduire le prompt
            </button>
            <button class="btn-secondary" id="btnCopy">
                <span class="emoji">üìã</span> Copier le r√©sultat
            </button>
            <button class="btn-danger" id="btnClear">
                <span class="emoji">üóëÔ∏è</span> Effacer tout
            </button>
        </div>

        <div class="stats">
            <div class="stat-chip">
                <span class="stat-label">Mots entr√©e :</span>
                <span class="stat-value" id="statInputWords">0</span>
            </div>
            <div class="stat-chip">
                <span class="stat-label">Mots sortie :</span>
                <span class="stat-value" id="statOutputWords">0</span>
            </div>
            <div class="stat-chip">
                <span class="stat-label">Facteur d‚Äôexpansion :</span>
                <span class="stat-value" id="statRatio">0%</span>
            </div>
        </div>

        <div class="footer-note">
            ‚å®Ô∏è Raccourci : <strong>Ctrl + Entr√©e</strong> dans le champ de gauche pour traduire.
        </div>
    </main>
</div>

<script>
    // --- Utils de texte ------------------------------------------------------

    function countWords(text) {
        if (!text) return 0;
        return text
            .trim()
            .split(/\s+/)
            .filter(Boolean)
            .length;
    }

    function updateStats() {
        const input = document.getElementById('inputPrompt').value;
        const output = document.getElementById('outputPrompt').value;

        const inCount = countWords(input);
        const outCount = countWords(output);

        document.getElementById('statInputWords').textContent = inCount;
        document.getElementById('statOutputWords').textContent = outCount;

        const ratioEl = document.getElementById('statRatio');
        if (inCount > 0 && outCount > 0) {
            const ratio = Math.round((outCount / inCount) * 100);
            ratioEl.textContent = ratio + '%';
        } else {
            ratioEl.textContent = '0%';
        }
    }

    // D√©tection grossi√®re du type de t√¢che pour ajuster le r√¥le / objectif
    function detectTaskType(prompt) {
        const p = prompt.toLowerCase();

        if (p.match(/\b(code|programme|script|fonction|html|css|javascript|python)\b/)) {
            return 'coding';
        }
        if (p.match(/\b(ocr|json|extraction|convertis|structure|analyse|parser|parse)\b/)) {
            return 'ocr_json';
        }
        if (p.match(/\b(r√©dige|√©cris|article|texte|story|histoire|post|mail|email)\b/)) {
            return 'writing';
        }
        if (p.match(/\b(r√©sume|synth√©tise|condense|summary)\b/)) {
            return 'summary';
        }
        if (p.match(/\b(explique|d√©cris|p√©dagogue|cours|le√ßon|lecon)\b/)) {
            return 'explanation';
        }
        if (p.match(/\b(liste|√©num√®re|checklist|points cl√©s|bullet points)\b/)) {
            return 'listing';
        }
        if (p.match(/\b(plan|strat√©gie|strategie|architecture|con√ßois|design)\b/)) {
            return 'strategy';
        }

        return 'general';
    }

    // G√©n√®re les blocs de r√¥le / objectif / contraintes selon le type
    function buildConstraints(taskType) {
        const c = {
            role: '',
            objective: '',
            constraints: '',
            format: '',
            validation: ''
        };

        switch (taskType) {
            case 'coding':
                c.role = "Tu es un d√©veloppeur senior, expert dans le langage / stack le plus adapt√© √† la demande, " +
                         "avec une obsession pour le code propre, lisible et directement ex√©cutable.";
                c.objective = "Produire du code complet, fonctionnel, sans TODO, avec les imports et d√©pendances n√©cessaires.";
                c.constraints =
`- Le code doit √™tre imm√©diatement ex√©cutable (ou int√©grable) sans modifications majeures
- Respect strict des bonnes pratiques du langage (nommage, structure, gestion des erreurs)
- Commenter uniquement les parties non triviales
- Mentionner clairement les d√©pendances √©ventuelles (biblioth√®ques, runtime, etc.)
- Si plusieurs approches sont possibles, choisir la plus simple et robuste`;
                c.format =
`1. Bloc de code complet (sans blabla avant/apr√®s)
2. Br√®ve explication (5‚Äì10 lignes max) si n√©cessaire
3. Exemple d‚Äôappel / d‚Äôutilisation si pertinent
4. Liste √©ventuelle des d√©pendances (version minimale si utile)`;
                c.validation =
`- [ ] Le code est complet (pas de pseudo-code, pas de "‚Ä¶" ou de TODO)
- [ ] Tous les imports / d√©pendances n√©cessaires sont pr√©sents
- [ ] Les cas d‚Äôerreur √©vidents sont g√©r√©s proprement
- [ ] Le style respecte les conventions du langage
- [ ] Un exemple d‚Äôutilisation est fourni si utile`;
                break;

            case 'ocr_json':
                c.role = "Tu es un expert mondial en OCR s√©mantique, structuration de documents et mod√©lisation JSON pour GPT personnalis√©.";
                c.objective = "Transformer le contenu (texte, pages, consignes) en un JSON parfaitement structur√©, exploitable directement comme base de connaissance pour un GPT sp√©cialis√©.";
                c.constraints =
`- Extraire / organiser l‚Äôinformation par niveaux logiques : document ‚Üí chapitres ‚Üí sections ‚Üí √©l√©ments (concepts, exercices, exemples‚Ä¶)
- Tol√©rance maximale aux incertitudes : d√®s qu‚Äôun mot, une phrase ou un passage est illisible, tu √©cris "[illisible]" au lieu de bloquer
- Tu dois pr√©f√©rer la compl√©tude structur√©e √† la perfection micro-typographique
- Les cl√©s JSON doivent √™tre en snake_case, explicites et stables
- Aucune m√©ta-explication dans le JSON (pas de phrases du type "ici je‚Ä¶")`;
                c.format =
`Tu fournis UNIQUEMENT un objet JSON valide, sans texte autour, de la forme :

{
  "document_metadata": { ... },
  "structure_hierarchique": { ... },
  "index_concepts": [ ... ],
  "statistiques": { ... }
}

Adapte les sous-structures au besoin, mais respecte :
- Une hi√©rarchie claire
- Des tableaux pour les listes
- Des cha√Ænes de caract√®res pour les contenus textuels`;
                c.validation =
`- [ ] Le JSON est valide (accolades et crochets √©quilibr√©s, guillemets corrects)
- [ ] Tous les niveaux logiques utiles sont bien repr√©sent√©s
- [ ] Les zones floues / illisibles sont marqu√©es "[illisible]" au lieu d‚Äô√™tre ignor√©es
- [ ] Aucune explication m√©ta n‚Äôest incluse dans les valeurs JSON
- [ ] La structure est coh√©rente d‚Äôun bout √† l‚Äôautre (m√™mes cl√©s pour m√™mes types d‚Äô√©l√©ments)`;
                break;

            case 'writing':
                c.role = "Tu es un r√©dacteur expert, sp√©cialis√© dans les contenus clairs, structur√©s et engageants.";
                c.objective = "Produire un texte complet et agr√©able √† lire, qui r√©pond pr√©cis√©ment √† la demande.";
                c.constraints =
`- Ton : professionnel, clair et humain (pas de phrases robotiques)
- Structure logique avec titres et sous-titres
- Utiliser des exemples concrets quand c‚Äôest pertinent
- √âviter les redites et les remplissages creux
- Pas de fautes d‚Äôorthographe majeures`;
                c.format =
`1. Introduction courte qui pose le contexte
2. 2 √† 4 grandes parties avec sous-titres
3. Conclusion concise avec id√©e-cl√© ou ouverture`;
                c.validation =
`- [ ] La demande initiale est trait√©e explicitement
- [ ] Le texte est structur√© avec titres / sous-titres
- [ ] Des exemples concrets sont pr√©sents si utiles
- [ ] Le ton est homog√®ne et coh√©rent
- [ ] Aucune section n‚Äôest du remplissage vide`;
                break;

            case 'summary':
                c.role = "Tu es un expert en synth√®se qui condense l‚Äôinformation sans perdre les points essentiels.";
                c.objective = "Produire un r√©sum√© fid√®le, hi√©rarchis√© et facile √† relire.";
                c.constraints =
`- Longueur cible : ~30% maximum du volume initial (sauf indication contraire)
- Conserver toutes les id√©es principales, supprimer les d√©tails secondaires
- Organiser les id√©es par importance d√©croissante
- Reformuler avec tes mots (pas de copier-coller int√©gral)`;
                c.format =
`1. Phrase d‚Äôid√©e centrale
2. Liste de 3 √† 7 points cl√©s
3. Si utile : une phrase sur les implications / limites`;
                c.validation =
`- [ ] Les id√©es principales sont toutes pr√©sentes
- [ ] Le r√©sum√© est clairement plus court que l‚Äôoriginal
- [ ] La structure est lisible (points cl√©s hi√©rarchis√©s)
- [ ] Aucune interpr√©tation personnelle n‚Äôest introduite`;
                break;

            case 'explanation':
                c.role = "Tu es un p√©dagogue expert, capable d‚Äôexpliquer clairement des concepts √† diff√©rents niveaux.";
                c.objective = "Rendre le sujet compr√©hensible, m√™me pour quelqu‚Äôun qui ne le ma√Ætrise pas encore.";
                c.constraints =
`- Commencer simple, puis aller vers plus de nuance
- D√©finir les termes techniques d√®s leur premi√®re apparition
- Utiliser des exemples ou analogies parlantes
- √âviter le jargon inutile et les phrases trop longues`;
                c.format =
`1. D√©finition simple du sujet
2. D√©veloppement : comment √ßa fonctionne / pourquoi c‚Äôest important
3. Exemples concrets ou analogies
4. R√©capitulatif en 3 points maximum`;
                c.validation =
`- [ ] Le lecteur peut expliquer le concept en 2‚Äì3 phrases apr√®s lecture
- [ ] Au moins un exemple concret est donn√©
- [ ] Les termes techniques sont d√©finis clairement`;
                break;

            case 'listing':
                c.role = "Tu es un organisateur d‚Äôid√©es, sp√©cialiste des listes claires et actionnables.";
                c.objective = "Fournir une liste structur√©e et imm√©diatement exploitable.";
                c.constraints =
`- Nombre d‚Äô√©l√©ments : viser 8‚Äì15 items (sauf instruction contraire)
- Chaque item doit √™tre muni d‚Äôun titre court + 1‚Äì2 phrases explicatives
- Regrouper par cat√©gories si pertinent
- Garder un ordre logique (priorit√©, chronologie, etc.)`;
                c.format =
`Pour chaque √©l√©ment :
- Titre de l‚Äôitem
- Description courte
Optionnel : √©tiquette (cat√©gorie, niveau, priorit√©‚Ä¶)`;
                c.validation =
`- [ ] La liste couvre bien le p√©rim√®tre demand√©
- [ ] Chaque item est compr√©hensible tout seul
- [ ] L‚Äôordre choisi aide √† l‚Äôutilisation concr√®te`;
                break;

            case 'strategy':
                c.role = "Tu es un consultant / architecte strat√©gique, capable de proposer un plan clair et r√©aliste.";
                c.objective = "Concevoir une strat√©gie ou un plan structur√©, applicable dans le r√©el.";
                c.constraints =
`- Proposer une progression en √©tapes successives
- Pour chaque √©tape : objectif, actions, r√©sultats attendus
- √ätre r√©aliste sur l‚Äôeffort et les pr√©requis
- Distinguer bien : court terme / moyen terme / long terme si pertinent`;
                c.format =
`1. R√©sum√© de la strat√©gie en 5‚Äì7 lignes
2. Plan en √©tapes num√©rot√©es
3. Pour chaque √©tape : objectif, actions, livrable
4. Risques / points de vigilance principaux`;
                c.validation =
`- [ ] Toutes les grandes √©tapes n√©cessaires sont pr√©sentes
- [ ] Chaque √©tape est actionnable (action + livrable)
- [ ] Les risques majeurs sont identifi√©s`;
                break;

            default:
                c.role = "Tu es un assistant expert, parfaitement adapt√© √† la t√¢che d√©crite dans le prompt original.";
                c.objective = "R√©pondre √† la demande de mani√®re compl√®te, pr√©cise et exploitable imm√©diatement.";
                c.constraints =
`- Ne rien oublier de la demande initiale
- Privil√©gier la clart√© et la structure
- Donner des exemples concrets si utile
- √âviter les r√©ponses g√©n√©riques et vagues`;
                c.format =
`1. R√©ponse directe √† la question / t√¢che
2. D√©veloppement structur√©
3. Exemples / cas d‚Äôusage si pertinent`;
                c.validation =
`- [ ] Tous les √©l√©ments de la demande sont couverts
- [ ] La r√©ponse est structur√©e et lisible
- [ ] Le r√©sultat peut √™tre utilis√© tel quel sans te re-consulter`;
        }

        return c;
    }

    // G√©n√®re le super-prompt final
    function buildSuperPrompt(rawPrompt) {
        const taskType = detectTaskType(rawPrompt);
        const c = buildConstraints(taskType);

        const result =
`# R√îLE
${c.role}

# OBJECTIF
${c.objective}

# CONTRAINTES OBLIGATOIRES
${c.constraints}

# FORMAT DE SORTIE IMPOS√â
${c.format}

# VALIDATION AVANT ENVOI
Avant d'envoyer ta r√©ponse, v√©rifie mentalement :
${c.validation}

# MODE ANTI-PROCRASTINATION (IMPORTANT)
Tu NE DOIS PAS :
- Demander des clarifications, sauf si la demande est objectivement contradictoire
- Proposer plusieurs options sans choisir
- Sugg√©rer d'autres approches que celle demand√©e
- T'excuser pour des limites g√©n√©riques

Tu DOIS :
- Produire directement un r√©sultat complet, exploitable en ONE SHOT
- Prendre des d√©cisions raisonnables quand quelque chose n'est pas sp√©cifi√©
- Tol√©rer l'incertitude : si une information manque ou est floue, tu la signales clairement ("[illisible]" ou "[hypoth√®se raisonnable]") au lieu de bloquer

---

# PROMPT ORIGINEL √Ä EX√âCUTER
Utilise maintenant les sections ci-dessus pour traiter le prompt suivant :

[DEBUT_PROMPT_ORIGINAL]
${rawPrompt.trim()}
[FIN_PROMPT_ORIGINAL]`;

        return result;
    }

    // --- Gestion UI ----------------------------------------------------------

    const inputEl = document.getElementById('inputPrompt');
    const outputEl = document.getElementById('outputPrompt');
    const btnTranslate = document.getElementById('btnTranslate');
    const btnCopy = document.getElementById('btnCopy');
    const btnClear = document.getElementById('btnClear');

    btnTranslate.addEventListener('click', () => {
        const raw = inputEl.value.trim();
        if (!raw) {
            alert('‚ö†Ô∏è Mets d‚Äôabord un prompt brut dans la zone de gauche.');
            return;
        }

        const superPrompt = buildSuperPrompt(raw);
        outputEl.value = superPrompt;

        // petite animation visuelle
        outputEl.style.borderColor = '#22c55e';
        setTimeout(() => {
            outputEl.style.borderColor = '#e5e7eb';
        }, 900);

        updateStats();
    });

    btnCopy.addEventListener('click', (event) => {
        const text = outputEl.value.trim();
        if (!text) {
            alert('‚ö†Ô∏è Rien √† copier. Traduits d‚Äôabord un prompt.');
            return;
        }

        outputEl.focus();
        outputEl.select();
        try {
            const ok = document.execCommand('copy');
            if (!ok) throw new Error('execCommand √©chou√©');
        } catch (e) {
            navigator.clipboard?.writeText(text).catch(() => {
                alert('Impossible de copier automatiquement. Copie manuelle n√©cessaire.');
            });
        }

        const btn = event.currentTarget;
        const original = btn.innerHTML;
        btn.innerHTML = '<span class="emoji">‚úÖ</span> Copi√© !';
        btn.style.background = '#16a34a';

        setTimeout(() => {
            btn.innerHTML = original;
            btn.style.background = '#22c55e';
        }, 1800);
    });

    btnClear.addEventListener('click', () => {
        if (!confirm('Effacer le prompt d‚Äôentr√©e et le prompt optimis√© ?')) return;
        inputEl.value = '';
        outputEl.value = '';
        updateStats();
    });

    inputEl.addEventListener('input', updateStats);
    outputEl.addEventListener('input', updateStats);

    // Raccourci clavier : Ctrl+Enter dans le champ d'entr√©e
    inputEl.addEventListener('keydown', (e) => {
        if (e.ctrlKey && (e.key === 'Enter' || e.key === 'NumpadEnter')) {
            e.preventDefault();
            btnTranslate.click();
        }
    });

    // Init
    updateStats();
</script>
</body>
</html>
